generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id       Int      @id @default(autoincrement())
  name     String   @db.VarChar(100)
  birthday DateTime @db.Date
  password String   @db.VarChar(100)
  cpf      String   @unique @db.VarChar(14)
  email    String   @unique @db.VarChar(255)
  admin    Boolean  @default(false)
  pets     Pet[]
  address  Address?
}

model Address {
  id           Int    @id @default(autoincrement())
  code         String @db.VarChar(8)
  street       String @db.VarChar(100)
  number       String @db.VarChar(20)
  neighborhood String @db.VarChar(100)
  city         String @db.VarChar(100)
  state        String @db.VarChar(2)
  complement   String @db.VarChar(255)
  user         User   @relation(fields: [userId], references: [id])
  userId       Int    @unique
}

model Pet {
  id          Int       @id @default(autoincrement())
  name        String    @db.VarChar(100)
  species     String    @db.VarChar(100)
  breed       String    @db.VarChar(100)
  color       String    @db.VarChar(100)
  description String    @db.VarChar(255)
  gender      Gender
  age         Int
  user        User      @relation(fields: [userId], references: [id])
  userId      Int
  services    Service[]
}

enum Gender {
  M
  F
}

model Service {
  id         Int      @id @default(autoincrement())
  startDate  DateTime @db.Date
  endDate    DateTime @db.Date
  finished   Boolean  @default(false)
  pet        Pet      @relation(fields: [petId], references: [id])
  petId      Int
  room       Room     @relation(fields: [roomNumber], references: [number])
  roomNumber Int
  payment    Payment  @relation(fields: [paymentId], references: [id])
  paymentId  Int
}

model Payment {
  id          Int           @id @default(autoincrement())
  date        DateTime      @db.Date
  time        DateTime      @db.Date
  total       Float         @db.Double
  subtotal    Float         @db.Double
  installment Int           @db.Int
  discount    Float         @db.Double
  interest    Float         @db.Double
  serviceId   Int           @unique
  method      PaymentMethod
  status      PaymentStatus
  Service     Service[]
}

model Room {
  number    Int       @id
  available Boolean   @default(true)
  Service   Service[]
}

enum PaymentStatus {
  Paid
  Pending
  Refused
}

enum PaymentMethod {
  PIX
  CreditCard
}
